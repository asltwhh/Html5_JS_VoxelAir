<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./index.css" />
  </head>
  <body>
    <section id="wrap">
      <!-- 流体布局 -->
      <header id="head">
        <!-- 固定布局 -->
        <div class="headMain">
          <!-- 搜索引擎会扒这个logo -->
          <h1 class="logo">
            <a href="">
              <img src="./img/logo.png" alt="logo" />
            </a>
          </h1>
          <!-- 导航栏 -->
          <nav class="nav">
            <!-- 内部的li均浮动了，所以需要添加clearfix,避免高度塌陷 -->
            <ul class="list clearfix">
              <li>
                <a href="javascript:;">
                  <div class="up">
                    <img src="./img/home_gruen.png" alt="" />
                  </div>
                  <div class="down"><img src="./img/home.png" alt="" /></div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Course</div>
                  <div class="down">Course</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Works</div>
                  <div class="down">Works</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">About</div>
                  <div class="down">About</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Team</div>
                  <div class="down">Team</div>
                </a>
              </li>
            </ul>
          </nav>
          <!-- 箭头 -->
          <div class="arrow"></div>
        </div>
      </header>
      <!-- 内容区布局 -->
      <section id="content">
        <ul class="list">
          <li class="home"><section>home</section></li>
          <li class="course">
            <section>
              <header class="course1 commonTitle">
                <span>EINIGE </span><br />
                <span>UNSERER</span><br />
                <span>KUNDEN</span><br />
              </header>
              <div class="course2 commonText">
                <p>
                  Das Kundenvertrauen in unsere Kompetenz ist die notwendige
                  Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber
                  auch das größte Lob, das man uns entgegenbringen kann. Diese
                  und viele weitere große und kleine Kunden vertrauen uns seit
                  Jahren, was uns stolz macht, und dafür sagen wir an dieser
                  Stelle einfach mal.
                </p>
              </div>
              <div class="course3">
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <span class="line"></span>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
                <div class="item">
                  <div class="backface"></div>
                  <div class="face">lalalalal</div>
                </div>
              </div>
            </section>
          </li>
          <li class="works">
            <section>
              <header class="works1 commonTitle">
                <span>EINBLICK</span><br />
                <span>ERKENNTNIS</span><br />
                <span>ERGEBNIS</span><br />
              </header>
              <div class="works2">
                <div class="item">
                  <img src="img/worksimg1.jpg" alt="" />
                  <div class="mask">
                    <span>我有一只小花猫</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img src="img/worksimg2.jpg" alt="" />
                  <div class="mask">
                    <span>我有一只小花狗</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img src="img/worksimg3.jpg" alt="" />
                  <div class="mask">
                    <span>我有一只小花猪</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img src="img/worksimg4.jpg" alt="" />
                  <div class="mask">
                    <span>我有一只小花驴</span>
                    <div class="icon"></div>
                  </div>
                </div>
              </div>
              <div class="works3"></div>
            </section>
          </li>
          <li class="about"><section>about</section></li>
          <li class="team"><section>team</section></li>
        </ul>
      </section>
    </section>
    <script type="text/javascript">
      window.onload = function () {
        // 获取dom元素
        var arrowEle = document.querySelector("#head .headMain .arrow");
        var liNodes = document.querySelectorAll(
          "#head .headMain .nav .list li"
        );
        var upNodes = document.querySelectorAll(
          "#head .headMain .nav .list li .up"
        );
        var firstLiNode = liNodes[0];
        var firstUpNode = firstLiNode.querySelector(".up");

        let head = document.querySelector("#head");
        let content = document.querySelector("#content");
        let cliNodes = document.querySelectorAll("#content .list li");
        var clist = document.querySelector("#content .list");
        var now = 0;
        let timeId;
        // 处理头部
        headBind();
        // 内容区的交互
        contentBind();

        // 每次缩放，头部的高度会发生变化，所以需要调整内容区的宽度
        window.onresize = function () {
          // 调整每一屏的高度
          contentBind();
          // 每一屏的偏移量需要重新调整
          clist.style.top =
            -now * (document.documentElement.clientHeight - head.offsetHeight) +
            "px";
        };

        // 滚轮切换内容区
        if (content.addEventListener) {
          content.addEventListener("DOMMouseScroll", function (e) {
            e = e || event;
            // 防抖动
            if (timeId) {
              clearTimeout(timeId);
            }
            // 只有最近一次的滑动会被执行
            timeId = setTimeout(function () {
              fn(e);
            }, 200);
          });
        }
        content.onmousewheel = function (e) {
          e = e || event;
          // 防抖动
          if (timeId) {
            clearTimeout(timeId);
          }
          // 只有最近一次的滑动会被执行
          timeId = setTimeout(function () {
            fn(e);
          }, 200);
        };

        function fn(e) {
          let direction = "";
          e = e || event;
          if (e.wheelDelta) {
            direction = e.wheelDelta > 0 ? "up" : "down";
          } else if (e.detail) {
            direction = e.detail < 0 ? "up" : "down";
          }
          switch (direction) {
            case "up":
              if (now > 0) {
                now--;
                move(now);
              }

              break;
            case "down":
              if (now < cliNodes.length - 1) {
                now++;
                move(now);
              }
              break;
          }
          // 多次不松手滑动鼠标滚轮只响应一次 防抖节流
        }

        function contentBind() {
          // 动态指定内容区的高度
          content.style.height =
            document.documentElement.clientHeight - head.offsetHeight + "px";
          //   console.log(cliNodes);
          for (let i = 0; i < cliNodes.length; i++) {
            cliNodes[i].style.height =
              document.documentElement.clientHeight - head.offsetHeight + "px";
          }
        }

        function headBind() {
          // 设置箭头位置
          arrowEle.style.left =
            firstLiNode.offsetLeft +
            firstLiNode.offsetWidth / 2 -
            arrowEle.offsetWidth / 2 +
            "px";

          // 第一个li默认显示up,所以页面初加载时会有一个过渡的效果的展示
          firstUpNode.style.width = "100%";

          // 点击每一个nav，箭头就移动到对应li的正下方，并且该li的up展示
          for (let i = 0; i < liNodes.length; i++) {
            liNodes[i].onclick = function (event) {
              move(i);
            };
          }
        }
        //   这里面的功能后需要还可以用到，所以提取为一个单独的函数
        function move(i) {
          // 将所有的up均隐藏
          for (let j = 0; j < upNodes.length; j++) {
            // special One
            // 这里如果设置为0则会为其绑定内联样式，导致css无法对其产生修改
            // 设置为""则不会为其添加内联样式
            upNodes[j].style.width = "";
          }
          // 将当前点击的li对应的up展示
          upNodes[i].style.width = "100%";
          // 修改箭头的位置
          arrowEle.style.left =
            liNodes[i].offsetLeft +
            liNodes[i].offsetWidth / 2 -
            arrowEle.offsetWidth / 2 +
            "px";
          // 点击切换内容区的块
          clist.style.top =
            -i * (document.documentElement.clientHeight - head.offsetHeight) +
            "px";
          now = i;
        }
      };
    </script>
  </body>
</html>
